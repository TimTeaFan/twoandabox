<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Two And A Box</title>
    <!-- Local fonts are now loaded via CSS -->
    <link href="assets/bootstrap/bootstrap.min.css" rel="stylesheet">
    <link href="styles.css" rel="stylesheet">
</head>
<body class="bg-dark text-white">
    <header class="bg-dark shadow-sm sticky-top">
        <nav class="container px-4 py-3">
            <div class="navbar navbar-dark navbar-expand-lg p-0">
                <a href="/" class="text-primary text-decoration-none fw-bold font-renfrew responsive-logo">Two And A Box</a>
                <a href="tel:+491776332335" class="text-primary ms-auto me-3 d-lg-none phone-icon"><i class="fas fa-square-phone"></i></a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link text-light hover-warning" href="#home">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-light hover-warning" href="#anlässe">Anlässe</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-light hover-warning" href="#formation">Formation</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-light hover-warning" href="#programm">Programm</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-light hover-warning" href="#referenzen">Referenzen</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-light hover-warning" href="#kontakt">Kontakt</a>
                    </li>
                    </ul>
                    <a href="tel:+491776332335" class="text-primary ms-3 d-none d-lg-block phone-icon"><i class="fas fa-square-phone"></i></a>
                </div>
            </div>
        </nav>
    </header>

    <main>
        <section id="home" class="py-5 bg-gray-800">
            <div class="container px-4">
                <div class="row align-items-center g-4">
                    <div class="col-lg-7">
                        <div class="overflow-hidden">
                            <img src="images/Three_Panel_Color.webp" alt="Two And A Box performing live" class="img-fluid object-fit-cover">
                        </div>
                    </div>
                    <div class="col-lg-5">
                        <h1 class="display-4 fw-bold text-primary mb-4 font-renfrew">Two And A Box</h1>
                        <p class="lead text-light mb-4">
                            Ob Hochzeit, Firmenfest oder Weinlokal: Mit unserem breiten Repertoire und unserer flexiblen Besetzung bringen wir Stimmung in jede Location – egal wo!
                        </p>
                        <div class="d-flex gap-3 flex-wrap">
                            <a href="#kontakt" id="kontaktbtn" class="btn btn-warning btn-lg rounded-3">Jetzt kontaktieren</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="testimonials" class="py-5 bg-dark">
            <div class="container px-4">
                <div class="testimonial-container">
                    <div class="testimonial-card">
                        <div class="card bg-light text-light">
                            <div class="card-body">
                                <svg class="quote-icon" viewBox="0 0 24 24">
                                    <path d="M9.983 3v7.391c0 5.704-3.731 9.57-8.983 10.609l-.995-2.151c2.432-.917 3.995-3.638 3.995-5.849h-4v-10h9.983zm14.017 0v7.391c0 5.704-3.748 9.571-9 10.609l-.996-2.151c2.433-.917 3.996-3.638 3.996-5.849h-3.983v-10h9.983z"/>
                                </svg>
                                <p class="card-text">Two And A Box hat unsere Hochzeit zu etwas ganz Besonderem gemacht. Die Musikauswahl war perfekt und die Stimmung großartig!</p>
                                <footer class="text-primary fw-bold">Marie & Thomas K., Wiesbaden</footer>
                            </div>
                        </div>
                    </div>
                    <div class="testimonial-card d-none-mobile">
                        <div class="card bg-light text-light">
                            <div class="card-body">
                                <svg class="quote-icon" viewBox="0 0 24 24">
                                    <path d="M9.983 3v7.391c0 5.704-3.731 9.57-8.983 10.609l-.995-2.151c2.432-.917 3.995-3.638 3.995-5.849h-4v-10h9.983zm14.017 0v7.391c0 5.704-3.748 9.571-9 10.609l-.996-2.151c2.433-.917 3.996-3.638 3.996-5.849h-3.983v-10h9.983z"/>
                                </svg>
                                <p class="card-text">Professionell, flexibel und mit viel Gefühl für die richtige Musik zum richtigen Zeitpunkt. Absolut empfehlenswert!</p>
                                <footer class="text-primary fw-bold">Stefan M., Firmenevent Frankfurt</footer>
                            </div>
                        </div>
                    </div>
                    <div class="testimonial-card d-none-mobile">
                        <div class="card bg-light text-light">
                            <div class="card-body">
                                <svg class="quote-icon" viewBox="0 0 24 24">
                                    <path d="M9.983 3v7.391c0 5.704-3.731 9.57-8.983 10.609l-.995-2.151c2.432-.917 3.995-3.638 3.995-5.849h-4v-10h9.983zm14.017 0v7.391c0 5.704-3.748 9.571-9 10.609l-.996-2.151c2.433-.917 3.996-3.638 3.996-5.849h-3.983v-10h9.983z"/>
                                </svg>
                                <p class="card-text">Eine Band, die ihr Handwerk versteht. Haben unser Sommerfest perfekt musikalisch begleitet.</p>
                                <footer class="text-primary fw-bold">Christina R., Mainz</footer>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="demo" class="py-5 bg-purple">
            <div class="container px-4">
                <div class="row align-items-center g-4">
                    <div class="col-lg-6 order-1 order-lg-1">
                        <h3 class="display-5 fw-bold text mb-4">Demo anhören!</h2>
                        <p class="lead text-light mb-4">
                            Hier könnt ihr euch unsere Demo direkt anhören oder herunterladen.
                            <br><br>
                            Falls ihr mehr Soundschnippsel hören wollt, schreibt uns wir schicken euch gerne einen Link per <a href="mailto:twoandabox@gmx.de">E-Mail</a>.
                        </p>
                    </div>
                    <div class="col-lg-6 order-2 order-lg-2">
                        <p>Playing now: Two And A Box Demo</p>
                        <div class="audio-player-container">
                            <audio controls class="custom-audio-player">
                                <source src="downloads/Twoandabox_demo.mp3" type="audio/mpeg">
                                Dein Browser unterstützt das Audio-Element nicht.
                            </audio>
                        </div>
                        <div class="text-center mt-3">
                            <a href="downloads/Twoandabox_demo.mp3" download class="btn btn-download">Demo herunterladen</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="anlässe" class="py-5 bg-gray-800">
            <div class="container px-4">
                <div class="row align-items-center g-4">
                    <div class="col-lg-5 order-1 order-lg-1">
                        <h2 class="display-5 fw-bold text-primary mb-4">Anlässe</h2>
                        <p class="lead text-light mb-4">
                            Wir bieten die perfekte musikalische Untermalung für verschiedene Anlässe. Von Hochzeitsfeiern im kleinen Kreis bis hin zu großen Firmenevents - unser vielseitiges Repertoire passt sich deinen Bedürfnissen an.
                        </p><p class="lead text-light mb-4">
                            Two And A Box passt in jede Location und macht dein Event unvergesslich!
                        </p>
                    </div>
                    <div class="col-lg-7 order-2 order-lg-2">
                        <div id="formationCarousel" class="carousel slide" data-bs-ride="carousel" data-bs-interval="10000">
                            <div class="carousel-inner overflow-hidden">
                                <div class="carousel-item active">
                                    <img src="images/All_Three_Rockig_Stage.webp" alt="Rainer, Sybilla, Hajo und Drummer spielen auf großer Showbühne" class="img-fluid w-100 object-fit-cover">
                                    <div class="carousel-caption text-start">
                                        <h5>Große Bühnen</h5>
                                    </div>
                                </div>
                                <div class="carousel-item">
                                    <img src="images/Rainer_Sybilla_Hochzeit.webp" alt="Rainer und Sybilla auf der Bühne" class="img-fluid w-100 object-fit-cover">
                                    <div class="carousel-caption text-start">
                                        <h5>Hochzeiten</h5>
                                    </div>
                                </div>
                                <div class="carousel-item">
                                    <img src="images/Rainer_Hajo_Strassenfest.webp" alt="Rainer und Hajo vor der Bühne beim Strassenfest" class="img-fluid w-100 object-fit-cover focus-left-top">
                                    <div class="carousel-caption text-start">
                                        <h5>Strassenfeste</h5>
                                    </div>
                                </div>
                                <div class="carousel-item">
                                    <img src="images/Rainer_Sybilla_Restaurant.webp" alt="Rainer und Sybilla spiele im Restaurant" class="img-fluid w-100 object-fit-cover focus-left2-top">
                                    <div class="carousel-caption text-start">
                                        <h5>Privatfeiern</h5>
                                    </div>
                                </div>
                                <div class="carousel-item">
                                    <img src="images/Rainer_Firmenevent.webp" alt="Rainer performt auf moderner Bühne eines Firmenevents" class="img-fluid w-100 object-fit-cover">
                                    <div class="carousel-caption text-start">
                                        <h5>Firmenevents</h5>
                                    </div>
                                </div>
                                <div class="carousel-item">
                                    <img src="images/Rainer_Hotelbar.webp" alt="Rainer spielt in einer Hotelbar" class="img-fluid w-100 object-fit-cover focus-left-top">
                                    <div class="carousel-caption text-start">
                                        <h5>Hotelbars</h5>
                                    </div>
                                </div>
                                <div class="carousel-item">
                                    <img src="images/three_shot_pic.webp" alt="Rainer, Hajo, Sybilla formell in Schwarz gekleidet" class="img-fluid w-100 object-fit-cover focus-left-top">
                                    <div class="carousel-caption text-start">
                                        <h5>Formelle Anlässe</h5>
                                    </div>
                                </div>
                            </div>
                            <div class="carousel-controls-wrapper d-flex justify-content-center align-items-center gap-4 mt-3">
                                <button class="carousel-control-prev position-relative" type="button" data-bs-target="#formationCarousel" data-bs-slide="prev">
                                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                    <span class="visually-hidden">Previous</span>
                                </button>
                                <div class="carousel-indicators position-relative mb-0 d-flex gap-2">
                                    <button type="button" data-bs-target="#formationCarousel" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                                    <button type="button" data-bs-target="#formationCarousel" data-bs-slide-to="1" aria-label="Slide 2"></button>
                                    <button type="button" data-bs-target="#formationCarousel" data-bs-slide-to="2" aria-label="Slide 3"></button>
                                    <button type="button" data-bs-target="#formationCarousel" data-bs-slide-to="3" aria-label="Slide 4"></button> 
                                    <button type="button" data-bs-target="#formationCarousel" data-bs-slide-to="4" aria-label="Slide 5"></button> 
                                    <button type="button" data-bs-target="#formationCarousel" data-bs-slide-to="5" aria-label="Slide 6"></button>
                                    <button type="button" data-bs-target="#formationCarousel" data-bs-slide-to="6" aria-label="Slide 7"></button> 
                                </div>
                                <button class="carousel-control-next position-relative" type="button" data-bs-target="#formationCarousel" data-bs-slide="next">
                                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                    <span class="visually-hidden">Next</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="formation" class="py-5 bg-dark">
            <div class="container px-4">
                <h2 class="display-5 fw-bold text-primary mb-3 text-center">Formation</h2>
                <p class="lead text-light text-center mb-5">
                    Flexibel und vielseitig - Das Two And A Box System!
                <br>
                    Duo, Trio oder als One-Man-Show? Mit Sängerin oder mit Drumcomputer und Beatmaschine? Du entscheidest, wir liefern – maßgeschneidert für dein Event!
                </p>
                <div class="row g-4">
                    <div class="col-lg-4">
                        <div class="card bg-light text-light h-100 formation-card">
                            <img src="images/Rainer_Gitarre.webp" class="card-img-top mobile-optimized" alt="One-Man-Show">
                            <div class="card-body">
                                <h3 class="card-title h4 text-primary mb-3">One-Man-Show</h3>
                                <p class="card-text">Dank Drumcomputer und Beatmaschine auch Solo ein umwerfender Sound für Bühnen jeder Größe.</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="card bg-light text-light h-100 formation-card">
                            <img src="images/Rainer_Sybilla_Rockig_Stage.webp" class="card-img-top mobile-optimized" alt="Duo">
                            <div class="card-body">
                                <h3 class="card-title h4 text-primary mb-3">Duo</h3>
                                <p class="card-text">Gitarre und Gesang im harmonischen Zusammenspiel. Ideal für mittelgroße Events mit breitem musikalischem Spektrum.</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="card bg-light text-light h-100 formation-card">
                            <img src="images/three_shot_pic.webp" class="card-img-top mobile-optimized" alt="Trio">
                            <div class="card-body">
                                <h3 class="card-title h4 text-primary mb-3">Trio</h3>
                                <p class="card-text">Die volle Bandbreite mit mehrstimmigem Gesang. Kraftvoller Sound für große Veranstaltungen und Festivals.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="programm" class="py-5 bg-gray-800">
            <div class="container px-4">
                <div class="row align-items-center g-4">
                    <div class="col-lg-6 order-lg-2 order-2">
                        <div class="song-table-container">
                            <h4 class="text-primary mb-3">Unser Repertoire</h4>
                            <div class="search-container mb-3">
                                <input type="text" id="songSearch" class="form-control" placeholder="Song suchen...">
                            </div>
                            <div class="table-responsive rounded">
                                <table id="songTable" class="table table-dark table-hover mb-0">
                                    <thead>
                                        <tr>
                                            <th scope="col" class="song-title">Titel</th>
                                        </tr>
                                    </thead>
                                    <tbody id="songTableBody">
                                        <!-- Songs will be loaded here -->
                                        <tr>
                                            <td class="text-center">Lade Songs...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="pagination-container d-flex justify-content-between align-items-center mt-3">
                                <button id="prevPage" class="btn btn-sm btn-outline-warning" disabled>Zurück</button>
                                <span id="pageInfo" class="text-light">Seite 1</span>
                                <button id="nextPage" class="btn btn-sm btn-outline-warning">Weiter</button>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6 order-lg-1 order-1">
                        <h2 class="display-5 fw-bold text-primary mb-4">Programm</h2>
                        <p class="lead text-light">
                            Von Rock bis Schlager – wir spielen alles!
                            <br><br>
                            Rock, Pop, Blues, Oldies, Top-Hits von den 70ern bis heute: Eric Clapton, Prince und mehr, frisch interpretiert. Dazu Tisch-, Tanz- und Stimmungsmusik sowie Schlager und Medleys – für jeden Moment die passende Note!
                            <br><br>
                            Werft gerne einen Blick in unserer Programm!
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <section id="referenzen" class="py-5 bg-dark">
            <div class="container px-4">
                <h2 class="display-5 fw-bold text-primary mb-4 text-center">Referenzen</h2>
                <p class="lead text-light text-center mb-5">

                    Überall unterwegs, überall gefeiert! Von Hamburg bis München, aber vor allem im Rheingau.
                    Von kleinen Pubs bis zu großen Festen – wir haben schon viele Bühnen gerockt und Menschen begeistert. Akustisch, unplugged oder volle Power: Unsere Referenzen sprechen für sich!
                    </p>
                    
                <div class="tabs-container mb-4">
                    <div class="tabs d-flex flex-wrap pb-2">
                        <button class="tab tab-all active" data-category="all">Alle Referenzen</button>
                        <button class="tab tab-yellow" data-category="Weingüter und Hoffeste">Weingüter & Hoffeste</button>
                        <button class="tab tab-purple" data-category="Wein- und Straßenfeste">Wein- & Straßenfeste</button>
                        <button class="tab tab-blue" data-category="Firmen, Vereine, Stadtverwaltungen">Firmen & Vereine</button>
                    </div>
                </div>
                
                <div class="search-container mb-4">
                    <input type="text" class="form-control search-input" placeholder="Referenz oder Ort suchen...">
                </div>
                
                <div class="references-navigation-container position-relative">
                    <button class="reference-nav-arrow reference-nav-prev" id="referencesPrev" aria-label="Previous references">
                        <i class="fas fa-caret-left"></i>
                    </button>
                    
                    <div class="content-area">
                        <div class="reference-list" id="references-container">
                            <!-- References will be populated here by JavaScript -->
                        </div>
                        <div class="reference-pagination mt-3 d-flex justify-content-center" id="references-pagination">
                            <!-- Pagination will be populated here by JavaScript -->
                        </div>
                    </div>
                    
                    <button class="reference-nav-arrow reference-nav-next" id="referencesNext" aria-label="Next references">
                        <i class="fas fa-caret-right"></i>
                    </button>
                </div>
            </div>
        </section>

        <section id="kontakt" class="py-5 bg-gray-800">
            <div class="container px-4">
                <div class="row align-items-center g-4">
                    <div class="col-lg-6 order-1 order-lg-1">
                        <h2 class="display-5 fw-bold text-primary mb-4">Kontakt</h2>
                        <p class="lead text-light">
                            
                            Lass uns gemeinsam feiern!
                            <br><br>
                            Du planst ein Event und suchst die perfekte Band?
                            <br>
                            Schreib uns an <a href="mailto:twoandabox@gmx.de">twoandabox@gmx.de</a> oder
                            <br>
                            ruf uns an unter <a href="tel:+491776332335">0177 633 233 5</a>.
                            <br><br>
                            Wir freuen uns darauf, dein Event musikalisch zu begleiten!
                        </p>
                    </div>
                    <div class="col-lg-6 order-2 order-lg-2">
                        <form name="contact" method="POST" class="bg-gray-800 p-4 rounded" netlify>
                            <div class="row g-3 mb-3">
                                <div class="col-md-6">
                                    <input type="text" class="form-control" name="vorname" placeholder="Vorname" required>
                                </div>
                                <div class="col-md-6">
                                    <input type="text" class="form-control" name="nachname" placeholder="Nachname" required>
                                </div>
                            </div>
                            <div class="mb-3">
                                <input type="email" class="form-control" name="email" placeholder="E-Mail" required>
                            </div>
                            <div class="mb-3">
                                <input type="tel" class="form-control" name="telefon" placeholder="Telefonnummer (im Falle ein Rückruf gewünscht ist)">
                            </div>
                            <div class="mb-3">
                                <textarea class="form-control" name="nachricht" rows="5" placeholder="Nachricht" required></textarea>
                            </div>
                            <button type="submit" class="btn btn-warning rounded-3">Absenden</button>
                        </form>
                        </p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="py-5 bg-dark">
        <div class="container px-4">
            <div class="row g-3">
                <div class="col-md-6">
                    <h5 class="text-primary font-renfrew mb-3">Two And A Box</h5>
                    <p class="text-light mb-1">Maßgeschneiderte Livemusik für jeden Anlass!</p>
                    <p class="text-light mb-0">&copy; <span id="year">2025</span> Two And A Box. Alle Rechte vorbehalten.</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <h5 class="text-primary mb-3">Kontakt</h5>
                    <p class="text-light mb-1">Rainer Tiefenbach</p>
                    <p class="text-light mb-1"><a href="tel:+491776332335"><i class="fas fa-phone me-2"></i>0177 633 233 5</a></p>
                    <p class="text-light mb-3"><a href="mailto:twoandabox@gmx.de"><i class="fas fa-envelope me-2"></i>twoandabox@gmx.de</a></p>
                </div>
                <div class="col-12 text-center mt-2">
                    <a href="/impressum.html" class="text-light me-3 text-decoration-none hover-warning"><i class="fas fa-balance-scale-left me-1"></i>Impressum</a>
                    <a href="/data_policy.html" class="text-light me-3 text-decoration-none hover-warning"><i class="fas fa-fingerprint me-1"></i>Datenschutzerklärung</a>
                    <a href="/lizenzen.html" class="text-light text-decoration-none hover-warning"><i class="fas fa-info-circle me-1"></i>Lizenzen</a>
                </div>
            </div>
        </div>
    </footer>

    <script src="assets/bootstrap/bootstrap.bundle.min.js"></script>
    <link href="assets/fontawesome/all.min.css" rel="stylesheet">
    <script src="main.js"></script>
    
    <!-- Referenzen Section Script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const tabButtons = document.querySelectorAll('#referenzen .tab');
            const searchInput = document.querySelector('#referenzen .search-input');
            const referencesContainer = document.getElementById('references-container');
            const referencesPagination = document.getElementById('references-pagination');
            const prevButton = document.getElementById('referencesPrev');
            const nextButton = document.getElementById('referencesNext');
            
            // Current state
            let activeCategory = 'all';
            let searchTerm = '';
            let referencesData = {};
            let currentPage = 1;
            let totalPages = 1;
            
            // Configuration
            let itemsPerPage = getItemsPerPage();
            
            // Function to determine items per page based on screen size
            function getItemsPerPage() {
                const width = window.innerWidth;
                if (width >= 1036) { // Large screens: 4 rows x 3 columns
                    return 12;
                } else if (width >= 756) { // Medium screens: 4 rows x 2 columns
                    return 8;
                } else { // Mobile: 4 rows x 1 column
                    return 4;
                }
            }
            
            // Update items per page on window resize
            window.addEventListener('resize', () => {
                const newItemsPerPage = getItemsPerPage();
                if (newItemsPerPage !== itemsPerPage) {
                    itemsPerPage = newItemsPerPage;
                    displayReferences();
                }
            });
            
            // Initialize tooltips after DOM is fully loaded
            function initTooltips() {
                const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
                tooltipTriggerList.map(function (tooltipTriggerEl) {
                    return new bootstrap.Tooltip(tooltipTriggerEl);
                });
            }
            
            // Load references data
            fetch('referenzen.json')
                .then(response => response.json())
                .then(data => {
                    referencesData = data;
                    displayReferences();
                })
                .catch(error => {
                    console.error('Error loading references:', error);
                    referencesContainer.innerHTML = `
                        <div class="no-results">
                            <p>Fehler beim Laden der Referenzen</p>
                        </div>
                    `;
                });
            
            // Event Listeners
            tabButtons.forEach(tab => {
                tab.addEventListener('click', () => {
                    tabButtons.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    activeCategory = tab.dataset.category;
                    currentPage = 1; // Reset to first page when changing category
                    displayReferences();
                });
            });
            
            searchInput.addEventListener('input', (e) => {
                searchTerm = e.target.value.toLowerCase();
                currentPage = 1; // Reset to first page when searching
                displayReferences();
            });
            
            // Navigation buttons
            prevButton.addEventListener('click', () => {
                if (currentPage > 1) {
                    currentPage--;
                    displayReferences();
                }
            });
            
            nextButton.addEventListener('click', () => {
                if (currentPage < totalPages) {
                    currentPage++;
                    displayReferences();
                }
            });
            
            // Function to display references based on current filters and page
            function displayReferences() {
                // Clear the containers
                referencesContainer.innerHTML = '';
                referencesPagination.innerHTML = '';
                
                if (!referencesData || Object.keys(referencesData).length === 0) {
                    return;
                }
                
                // Get all references that match the current filters
                let allFilteredReferences = [];
                
                if (activeCategory === 'all') {
                    Object.keys(referencesData).forEach(category => {
                        referencesData[category].forEach(ref => {
                            allFilteredReferences.push({...ref, category});
                        });
                    });
                } else {
                    allFilteredReferences = referencesData[activeCategory].map(ref => ({...ref, category: activeCategory}));
                }
                
                // Apply search filtering
                if (searchTerm) {
                    allFilteredReferences = allFilteredReferences.filter(ref => 
                        ref.name.toLowerCase().includes(searchTerm) || 
                        ref.ort.toLowerCase().includes(searchTerm)
                    );
                }
                
                // Calculate total pages
                totalPages = Math.ceil(allFilteredReferences.length / itemsPerPage);
                
                // Adjust current page if needed
                if (currentPage > totalPages) {
                    currentPage = totalPages || 1;
                }
                
                // Update navigation buttons state
                prevButton.disabled = currentPage <= 1;
                nextButton.disabled = currentPage >= totalPages;
                
                // Display the references for the current page
                if (allFilteredReferences.length === 0) {
                    referencesContainer.innerHTML = `
                        <div class="no-results">
                            <p>Keine Ergebnisse gefunden</p>
                        </div>
                    `;
                    return;
                }
                
                // Calculate start and end indices for the current page
                const startIndex = (currentPage - 1) * itemsPerPage;
                const endIndex = Math.min(startIndex + itemsPerPage, allFilteredReferences.length);
                
                // Get references for the current page
                const referencesToShow = allFilteredReferences.slice(startIndex, endIndex);
                
                // Create and append reference elements
                referencesToShow.forEach(ref => {
                    const referenceElement = document.createElement('div');
                    referenceElement.className = 'reference-item';
                    
                    // Add category-specific class for styling
                    if (ref.category === 'Weingüter und Hoffeste') {
                        referenceElement.classList.add('category-weingüter');
                    } else if (ref.category === 'Wein- und Straßenfeste') {
                        referenceElement.classList.add('category-feste');
                    } else if (ref.category === 'Firmen, Vereine, Stadtverwaltungen') {
                        referenceElement.classList.add('category-firmen');
                    }
                    
                    // Add tooltip only if the text is likely to be truncated
                    // We'll use a character length check as a heuristic
                    const MAX_NAME_LENGTH = 29; // Adjust based on your design
                    const MAX_LOCATION_LENGTH = 35; // Adjust based on your design
                    
                    if (ref.name.length > MAX_NAME_LENGTH || ref.ort.length > MAX_LOCATION_LENGTH) {
                        const tooltip = `${ref.name} - ${ref.ort}`;
                        referenceElement.setAttribute('title', tooltip);
                        referenceElement.setAttribute('data-bs-toggle', 'tooltip');
                        referenceElement.setAttribute('data-bs-placement', 'top');
                    }
                    
                    // Use a simpler structure to ensure text truncation
                    referenceElement.innerHTML = `
                        <div class="reference-name" title="${ref.name}">${ref.name}</div>
                        <div class="reference-location" title="${ref.ort}">${ref.ort}</div>
                    `;
                    
                    referencesContainer.appendChild(referenceElement);
                });
                
                // Initialize tooltips after adding references
                setTimeout(initTooltips, 100);
                
                // Create pagination dots
                if (totalPages > 1) {
                    for (let i = 1; i <= totalPages; i++) {
                        const pageDot = document.createElement('span');
                        pageDot.className = `page-dot${i === currentPage ? ' active' : ''}`;
                        pageDot.dataset.page = i;
                        pageDot.addEventListener('click', () => {
                            currentPage = parseInt(pageDot.dataset.page);
                            displayReferences();
                        });
                        referencesPagination.appendChild(pageDot);
                    }
                }
            }
        });
    </script>
</body>
</html>
